import{jsxs as e,jsx as t,Fragment as r}from"react/jsx-runtime";import n,{memo as o,useRef as s,useLayoutEffect as i,useEffect as a,useCallback as l,useState as c}from"react";function u(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function p(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}"function"==typeof SuppressedError&&SuppressedError,function(e,t){void 0===t&&(t={});var r=t.insertAt;if("undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".signify_popup {\r\n    font-size: 12px;\r\n    width: 300px;\r\n    height: 300px;\r\n    background-color: white;\r\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);\r\n    position: fixed;\r\n    display: block;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    box-sizing: border-box;\r\n    border-radius: 10px;\r\n    overflow: hidden;\r\n}\r\n.signify_popup_header {\r\n    cursor: move;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 5px 20px;\r\n    gap: 10px;\r\n    font-size: 16px;\r\n    color: white;\r\n    user-select: none;\r\n}\r\n.signify_popup_header_button {\r\n    cursor: pointer;\r\n}\r\n.signify_popup_header_label {\r\n    margin-right: auto;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    text-wrap: nowrap;\r\n}\r\n.signify_popup_resizer {\r\n    width: 20px;\r\n    height: 20px;\r\n    background-color: rgba(0, 0, 0, 0.1);\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n    cursor: se-resize;\r\n    border-radius: 10px 0px 10px;\r\n}\r\n.signify_popup_json_viewer {\r\n    margin: 0;\r\n    height: calc(100% - 32px);\r\n    overflow: auto;\r\n    padding: 10px 20px;\r\n    white-space: pre;\r\n    box-sizing: border-box;\r\n}\r\n.signify_popup_json_viewer::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n.signify_popup_json_viewer::-webkit-scrollbar-thumb {\r\n    background: gray;\r\n}\r\n.signify_popup_json_viewer::-webkit-scrollbar-track {\r\n    background: #fff;\r\n}\r\n.signify_popup_json_key {\r\n    color: brown;\r\n}\r\n.signify_popup_json_string {\r\n    color: green;\r\n}\r\n.signify_popup_json_number {\r\n    color: blue;\r\n}\r\n.signify_popup_json_boolean {\r\n    color: purple;\r\n}\r\n.signify_popup_json_null {\r\n    color: gray;\r\n}\r\n");let f=100;const h=n=>o((({name:o,pick:c=e=>e,color:u})=>{const p=s(null);let h=`rs-${o}`,d=!1,g=!1,y=0,v=0,m=0;i((()=>{var e;if(p.current){const{x:t,y:r,h:n,w:o}=JSON.parse(null!==(e=function(e){let t=e+"=",r=decodeURIComponent(document.cookie).split(";");for(let e=0;e<r.length;e++){let n=r[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}(h))&&void 0!==e?e:"{}");t&&(p.current.style.left=t),r&&(p.current.style.top=r),o&&(p.current.style.width=o),n&&(p.current.style.height=n)}}),[]),a((()=>{const e=e=>{if(d&&p.current&&(p.current.style.left=e.clientX-y+"px",p.current.style.top=e.clientY-v+"px"),g&&p.current){const t=p.current.getBoundingClientRect(),r=e.clientX-t.left,n=e.clientY-t.top;r>100&&(p.current.style.width=`${r+10}px`),n>100&&(p.current.style.height=`${n+10}px`)}},t=()=>{d=!1,g=!1,document.body.style.cursor="default",p.current&&function(e,t,r=30){const n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);let o="expires="+n.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}(h,JSON.stringify({x:p.current.style.left,y:p.current.style.top,w:p.current.style.width,h:p.current.style.height}))};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}),[]);const b=l((({clientX:e,clientY:t})=>{var r,n;p.current&&(d=!0,p.current.style.zIndex=""+f++,y=e-(null===(r=p.current)||void 0===r?void 0:r.offsetLeft),v=t-(null===(n=p.current)||void 0===n?void 0:n.offsetTop))}),[]),w=l((e=>{g=!0,document.body.style.cursor="se-resize",e.preventDefault()}),[]),_=l((e=>()=>{p.current&&(p.current.style.fontSize||(p.current.style.fontSize="12px"),p.current.style.fontSize=Number(p.current.style.fontSize.replace("px",""))+(e?2:-2)+"px")}),[]),x=l((e=>("string"!=typeof e&&(e=JSON.stringify(e,void 0,2)),(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\ $^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,(function(e){let t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="signify_popup_json_'+t+'">'+e+"</span>"})))),[]);return e("div",{ref:p,className:"signify_popup",children:[e("div",{style:{backgroundColor:null!=u?u:`rgb(${Math.floor(128*Math.random())}, ${Math.floor(128*Math.random())}, ${Math.floor(128*Math.random())})`},className:"signify_popup_header",onMouseDown:b,children:[t("label",{className:"signify_popup_header_label",children:t(n,{children:()=>e(r,{children:[o," - ",++m]})})}),t("span",{className:"signify_popup_header_button",onClick:_(!0),dangerouslySetInnerHTML:{__html:"&bigtriangleup;"}}),t("span",{className:"signify_popup_header_button",onClick:_(!1),dangerouslySetInnerHTML:{__html:"&bigtriangledown;"}})]}),t(n,{children:e=>t("pre",{className:"signify_popup_json_viewer",dangerouslySetInnerHTML:{__html:x(JSON.stringify(c(e),null,2))}})}),t("div",{onMouseDown:w,className:"signify_popup_resizer"})]})}),(()=>!0)),d={LocalStorage:localStorage,SesionStorage:sessionStorage},g=(e,t)=>{var r;(null==t?void 0:t.key)&&d[null!==(r=null==t?void 0:t.type)&&void 0!==r?r:"LocalStorage"].setItem(t.key,JSON.stringify(e))},y=e=>e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length),v=e=>{const t=new Map;if(t.set(Date,(e=>new Date(e))),t.set(Map,((e,t)=>new Map(r(Array.from(e),t)))),t.set(Set,((e,t)=>new Set(r(Array.from(e),t)))),e.constructorHandlers)for(const r of e.constructorHandlers)t.set(r[0],r[1]);const r=(e,r)=>{const n=Object.keys(e),o=new Array(n.length);for(let s=0;s<n.length;s++){const i=n[s],a=e[i];"object"!=typeof a||null===a?o[i]=a:a.constructor!==Object&&t.get(a.constructor)?o[i]=t.get(a.constructor)(a,r):ArrayBuffer.isView(a)?o[i]=y(a):o[i]=r(a)}return o},n=e=>{if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return r(e,n);if(e.constructor!==Object&&t.get(e.constructor))return t.get(e.constructor)(e,n);const o={};for(const r in e){if(!1===Object.hasOwnProperty.call(e,r))continue;const s=e[r];"object"!=typeof s||null===s?o[r]=s:s.constructor!==Object&&t.get(s.constructor)?o[r]=t.get(s.constructor)(s,n):ArrayBuffer.isView(s)?o[r]=y(s):o[r]=n(s)}return o};return n(e)},m=(e,t)=>{if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,n,o;if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!m(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,o[n]))return!1;for(n=r;0!=n--;){var s=o[n];if(!m(e[s],t[s]))return!1}return!0}return e!=e&&t!=t},b=e=>(t,r)=>{i((()=>(e.add(t),()=>{e.delete(t)})),null!=r?r:[])},w=(e,t)=>(r=e=>e)=>{const n=c({})[1];return i((()=>{const t=()=>n({});return e.add(t),()=>{e.delete(t)}}),[]),r(t())},_=e=>n.createElement((()=>e())),x=e=>({children:t})=>t(e()),k=e=>o(x(e),(()=>!0));var S,j,M,O,E,N,T,W,z,C;class A{constructor(e,t){if(S.set(this,!0),j.set(this,void 0),M.set(this,void 0),O.set(this,void 0),E.set(this,new Set),N.set(this,void 0),T.set(this,void 0),W.set(this,void 0),z.set(this,(()=>{!u(this,S,"f")||u(this,W,"f")&&!u(this,W,"f").call(this,this.value)||u(this,E,"f").forEach((e=>e(this.value)))})),C.set(this,(e=>{var t,r;void 0!==e&&p(this,M,e,"f"),g(this.value,null===(t=u(this,O,"f"))||void 0===t?void 0:t.cache),null===(r=u(this,N,"f"))||void 0===r||r.call(this,this.value),u(this,z,"f").call(this)})),this.set=e=>{let t;if("function"==typeof e){let r={value:v(u(this,M,"f"))};e(r),t=r.value}else t=e;m(this.value,t)||u(this,T,"f")&&!u(this,T,"f").call(this,this.value,t)||u(this,C,"f").call(this,t)},this.stop=()=>{p(this,S,!1,"f")},this.resume=()=>{p(this,S,!0,"f"),u(this,z,"f").call(this)},this.reset=()=>{u(this,C,"f").call(this,v(u(this,j,"f")))},this.conditionUpdating=e=>p(this,T,e,"f"),this.conditionRendering=e=>p(this,W,e,"f"),this.use=w(u(this,E,"f"),(()=>this.value)),this.watch=b(u(this,E,"f")),this.html=_(this.use),this.Wrap=x(this.use),this.HardWrap=k(this.use),this.slice=e=>{let t,r=e(this.value),n=!0;const o=new Set,s=()=>{const s=e(this.value);!n||t&&!t(s)||(r=s,o.forEach((e=>e(s))))},i=w(o,(()=>r)),a={value:r,use:i,watch:b(o),html:_(i),Wrap:x(i),HardWrap:k(i),stop:()=>n=!1,resume:()=>{n=!0,s()},conditionRendering:e=>t=e,DevTool:h(k(i))};return u(this,E,"f").add((()=>{m(e(this.value),r)||s()})),Object.defineProperty(a,"value",{get:()=>r,enumerable:!1,configurable:!1}),a},this.DevTool=h(this.HardWrap),p(this,j,e,"f"),p(this,M,((e,t)=>{var r;if(null==t?void 0:t.key){const n=null!==(r=null==t?void 0:t.type)&&void 0!==r?r:"LocalStorage",o=d[n].getItem(t.key);if(o)return JSON.parse(o);d[n].setItem(t.key,JSON.stringify(e))}return e})(v(e),null==t?void 0:t.cache),"f"),p(this,O,t,"f"),null==t?void 0:t.syncKey){const{post:e,sync:r}=(({key:e,cb:t})=>{const r=`bc_${e}`,n=new BroadcastChannel(r);return n.onmessage=e=>t(e.data),{post:e=>{n.postMessage(e)},sync:e=>{const t=new BroadcastChannel("bcs");t.onmessage=t=>r===t.data&&n.postMessage(e()),t.postMessage(r)}}})({key:t.syncKey,cb:e=>{var t;p(this,M,e,"f"),g(this.value,null===(t=u(this,O,"f"))||void 0===t?void 0:t.cache),u(this,z,"f").call(this)}});p(this,N,e,"f"),r((()=>this.value))}}get value(){return u(this,M,"f")}}S=new WeakMap,j=new WeakMap,M=new WeakMap,O=new WeakMap,E=new WeakMap,N=new WeakMap,T=new WeakMap,W=new WeakMap,z=new WeakMap,C=new WeakMap;const L=(e,t)=>new A(e,t);export{L as signify};
//# sourceMappingURL=index.js.map
